clc;
clear all;
close all;

%for fixed data rate, varying self interference, outage probability
%calculation


R0 = 2;
x= 2.^R0-1;
N=1
n= 0:0.01:1
lamda=(10.^(10)/10)

z=((2*sqrt(x.^2+x))/lamda)

K=besselk(1,z);

I=(exp((-2./lamda)*x)).*z.*K

pout22=(1-((2./(1+(n*x))).*I)+(1./(1+(2*n*x))).*I.*I).^N

semilogy(n,pout22,'bo-')

hold on;
grid on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%R0 = 1;
x= 2.^R0-1;
N=2
n= 0:0.01:1
%lamda=(10.^(10)/10)

z=((2*sqrt(x.^2+x))/lamda)

K=besselk(1,z);

I=(exp((-2./lamda)*x)).*z.*K

pout22=(1-((2./(1+(n*x))).*I)+(1./(1+(2*n*x))).*I.*I).^N

semilogy(n,pout22,'m*-')

hold on;
grid on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%R0 = 1;
x= 2.^R0-1;
N=3
n= 0:0.01:1
%lamda=(10.^(10)/10)

z=((2*sqrt(x.^2+x))/lamda)

K=besselk(1,z);

I=(exp((-2./lamda)*x)).*z.*K

pout22=(1-((2./(1+(n*x))).*I)+(1./(1+(2*n*x))).*I.*I).^N

semilogy(n,pout22,'S-g')

hold on;
grid on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%R0= 1;

T=R0;
x=T;
N=1;
P=10.^(10./10);

sigma2_SR=1;
sigma2_RD=1;
sigma2_RR=0:0.01:1;

lamdaRD=1./(P.*sigma2_RD)

lamdaSR=1./(P.*sigma2_SR)
 
lamdaRR =1./(P.*sigma2_RR)

syms y

z=(1-(lamdaRD.*exp(-lamdaRD.*x)).*(int((exp((-((lamdaSR.*(x+y+1).*x)./y))-(lamdaRD.*y)))./(1+((lamdaSR.*(x+y+1).*x)./(lamdaRR.*y))),y,0,inf))).^N

semilogy(sigma2_RR,z,'--bo') 
hold on;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%R0=1;

T=R0;
x=T;
N=2;
%P=10.^(10./10);

sigma2_SR=1;
sigma2_RD=1;
sigma2_RR=0:0.01:1;

lamdaRD=1./(P.*sigma2_RD)

lamdaSR=1./(P.*sigma2_SR)
 
lamdaRR =1./(P.*sigma2_RR)

syms y

z=(1-(lamdaRD.*exp(-lamdaRD.*x)).*(int((exp((-((lamdaSR.*(x+y+1).*x)./y))-(lamdaRD.*y)))./(1+((lamdaSR.*(x+y+1).*x)./(lamdaRR.*y))),y,0,inf))).^N

semilogy(sigma2_RR,z,'--m*') 
hold on;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%R0=1;

T=R0;
x=T;
N=3;
%P=10.^(10./10);

sigma2_SR=1;
sigma2_RD=1;
sigma2_RR=0:0.01:1;

lamdaRD=1./(P.*sigma2_RD)

lamdaSR=1./(P.*sigma2_SR)
 
lamdaRR =1./(P.*sigma2_RR)

syms y

z=(1-(lamdaRD.*exp(-lamdaRD.*x)).*(int((exp((-((lamdaSR.*(x+y+1).*x)./y))-(lamdaRD.*y)))./(1+((lamdaSR.*(x+y+1).*x)./(lamdaRR.*y))),y,0,inf))).^N

semilogy(sigma2_RR,z,'--gS') 
hold on;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

axis([0.025,1,10.^(-7),1]);
legend('ARS M = 1','ARS M = 2 ','ARS M = 3','ORS M = 1','ORS M = 2 ','ORS M = 3')
xlabel('Self Interference(dB)') 
ylabel('Outage Probability')