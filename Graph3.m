clc;
clear all;
close all;

% self interfrence value eta=0.1

N=1
alpha=1;
beta=2;
eta=0.1;
lamda=10.^((0:30)./10);

n=0;
m=0;
i=0;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f00=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER1=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha*f00

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

n=1;
m=0;
i=0;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1 % double factorial value of d
e=(d1./((beta+2.*c).^(b+0.5)))
f10=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e
SER2=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f10

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
n=1;
m=1;
i=1;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f11=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER3=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f11

SER=SER1+SER2+SER3
semilogy(10*log10(lamda),(SER1+SER2+SER3),'bo-')
hold on;

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

% self interfrence value eta=0.05

N=1
alpha=1;
beta=2;
eta=0.05;
% lamda=10.^((0:5:30)./10);

n=0;
m=0;
i=0;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f00=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER1=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f00

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

n=1;
m=0;
i=0;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f10=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e
SER2=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f10

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
n=1;
m=1;
i=1;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f11=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER3=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f11

SER=SER1+SER2+SER3
semilogy(10*log10(lamda),(SER1+SER2+SER3),'>-m')

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

% self interfrence value eta=0.01

N=1
alpha=1;
beta=2;
eta=0.01;
% lamda=10.^((0:5:30)./10);

n=0;
m=0;
i=0;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f00=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER1=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f00

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

n=1;
m=0;
i=0;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f10=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e
SER2=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f10

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
n=1;
m=1;
i=1;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f11=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER3=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f11

SER=SER1+SER2+SER3
semilogy(10*log10(lamda),(SER1+SER2+SER3),'S-g')
grid on
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
legend('Simulated \eta = 0.1','Simulated \eta = 0.05 ','Simulated \eta = 0.01')
xlabel('Transmit Power [dB]') 
ylabel('SER')