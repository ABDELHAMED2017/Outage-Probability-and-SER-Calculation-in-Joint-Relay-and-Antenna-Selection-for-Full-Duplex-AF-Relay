clc;
clear all;
close all;

N=1;
alpha=1;
beta=2;
eta=0.05;
lamda=10.^((0:30)./10);

n=0;
m=0;
i=0;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f00=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER1=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha*f00

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

n=1;
m=0;
i=0;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1 
e=(d1./((beta+2.*c).^(b+0.5)))
f10=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER2=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f10

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
n=1;
m=1;
i=1;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f11=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER3=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f11

SER=SER1+SER2+SER3
semilogy(10*log10(lamda),(SER1+SER2+SER3),'bo-')
hold on;

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

N=2;
alpha=1;
beta=2;
eta=0.05;
lamda=10.^((0:30)./10);

n=0;
m=0;
i=0;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f00=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER1=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha*f00

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

n=1;
m=0;
i=0;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1 
e=(d1./((beta+2.*c).^(b+0.5)))
f10=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER2=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f10

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
n=1;
m=1;
i=1;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f11=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER3=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f11

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=2;
m=0;
i=0;
j=2;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f20=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER4=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f20

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=2;
m=1;
i=1;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f21=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER5=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f21

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=2;
m=2;
i=2;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f22=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER6=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f22


SER=SER1+SER2+SER3+SER4+SER5+SER6
semilogy(10*log10(lamda),(SER1+SER2+SER3+SER4+SER5+SER6),'m*-')
hold on;


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

N=3;
alpha=1;
beta=2;
eta=0.05;
lamda=10.^((0:30)./10);

n=0;
m=0;
i=0;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f00=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER1=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha*f00

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 

n=1;
m=0;
i=0;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1 
e=(d1./((beta+2.*c).^(b+0.5)))
f10=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER2=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f10

% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
n=1;
m=1;
i=1;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f11=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER3=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f11

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=2;
m=0;
i=0;
j=2;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f20=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER4=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f20

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=2;
m=1;
i=1;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f21=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER5=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f21

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=2;
m=2;
i=2;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f22=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER6=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f22

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=3;
m=0;
i=0;
j=3;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f30=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER7=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f30

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=3;
m=1;
i=1;
j=2;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f31=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER8=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f31

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=3;
m=2;
i=2;
j=1;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f32=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER9=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f32

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=3;
m=3;
i=3;
j=0;

a=n-(2*m)+i-j
b=2*(n-i-j)
c=((((10/3)*n)-((5/3)*m)-((2/3)*i)-((4/3)*j))*eta)+(((4*n)-(2*m))./lamda)

d=2*b-1

d1=1
e=(d1./((beta+2.*c).^(b+0.5)))
f33=nchoosek(i,m)*nchoosek(j,n-m)*2^(a-1)*sqrt(beta)*eta^b.*e

SER10=nchoosek(N,n)*nchoosek(n,m)*(-2)^m*alpha.*f33


SER=SER1+SER2+SER3+SER4+SER5+SER6+SER7+SER8+SER9+SER10
semilogy(10*log10(lamda),(SER1+SER2+SER3+SER4+SER5+SER6+SER7+SER8+SER9+SER10),'S-g')
hold on;


% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % 


legend('ARS Simulated M = 1','ARS Simulated M = 2 ','ARS Simulated M = 3')
xlabel('Transmit Power [dB]') 
ylabel('SER')