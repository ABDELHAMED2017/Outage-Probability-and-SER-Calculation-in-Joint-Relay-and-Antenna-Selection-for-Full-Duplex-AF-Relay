clc;
clear all;
close all;

R0=(1:10);

T=R0;
x=T;
N=1;
P=10.^(10./10);

sigma2_SR=1;
sigma2_RD=1;
sigma2_RR=0.05;

lamdaRD=1./(P.*sigma2_RD)

lamdaSR=1./(P.*sigma2_SR)
 
lamdaRR =1./(P.*sigma2_RR)

syms y

z=(1-(lamdaRD.*exp(-lamdaRD.*x)).*(int((exp((-((lamdaSR.*(x+y+1).*x)./y))-(lamdaRD.*y)))./(1+((lamdaSR.*(x+y+1).*x)./(lamdaRR.*y))),y,0,inf))).^N

semilogy(x,z,'m+-') 
hold on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

R0 = 1:10;
x= 2.^R0-1;
N=1
n=0.05
lamda=(10.^(10)/10)

z=((2*sqrt(x.^2+x))/lamda)

K=besselk(1,z);

I=(exp((-2./lamda)*x)).*z.*K

pout22=(1-((2./(1+(n*x))).*I)+(1./(1+(2*n*x))).*I.*I).^N

semilogy(R0,pout22,'bo-')

hold on;
grid on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

R0=(1:10);

T=R0;
x=T;
N=2;
P=10.^(10./10);

sigma2_SR=1;
sigma2_RD=1;
sigma2_RR=0.05;

lamdaRD=1./(P.*sigma2_RD)

lamdaSR=1./(P.*sigma2_SR)
 
lamdaRR =1./(P.*sigma2_RR)

syms y

z=(1-(lamdaRD.*exp(-lamdaRD.*x)).*(int((exp((-((lamdaSR.*(x+y+1).*x)./y))-(lamdaRD.*y)))./(1+((lamdaSR.*(x+y+1).*x)./(lamdaRR.*y))),y,0,inf))).^N

semilogy(x,z,'m+-') 
hold on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

R0 = 1:10;
x= 2.^R0-1;
N=2
n=0.05
lamda=(10.^(10)/10)

z=((2*sqrt(x.^2+x))/lamda)

K=besselk(1,z);

I=(exp((-2./lamda)*x)).*z.*K

pout22=(1-((2./(1+(n*x))).*I)+(1./(1+(2*n*x))).*I.*I).^N

semilogy(R0,pout22,'y*-')

hold on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

R0=(1:10);

T=R0;
x=T;
N=3;
P=10.^(10./10);

sigma2_SR=1;
sigma2_RD=1;
sigma2_RR=0.05;

lamdaRD=1./(P.*sigma2_RD)

lamdaSR=1./(P.*sigma2_SR)
 
lamdaRR =1./(P.*sigma2_RR)

syms y

z=(1-(lamdaRD.*exp(-lamdaRD.*x)).*(int((exp((-((lamdaSR.*(x+y+1).*x)./y))-(lamdaRD.*y)))./(1+((lamdaSR.*(x+y+1).*x)./(lamdaRR.*y))),y,0,inf))).^N

semilogy(x,z,'m+-') 
hold on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

R0 = 1:10;
x= 2.^R0-1;
N=3
n=0.05
lamda=(10.^(10)/10)

z=((2*sqrt(x.^2+x))/lamda)

K=besselk(1,z);

I=(exp((-2./lamda)*x)).*z.*K

pout22=(1-((2./(1+(n*x))).*I)+(1./(1+(2*n*x))).*I.*I).^N

semilogy(R0,pout22,'S-g')

hold on;
grid on;

axis([1,10,10.^(-7),1]);
legend('AS - ORS N = 1','AS-ORS N = 2 ','AS-ORS N = 3' , 'ORS N = 1','ORS N = 2', 'ORS N = 3')
title('Outage Probability vs Transmission Rate for N = 1,2,3 Relays')
xlabel('Bits/Second (bps)') 
ylabel('Outage Probability')